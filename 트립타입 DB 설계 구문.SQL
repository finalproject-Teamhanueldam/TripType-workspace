
-- ************************************************************
-- 0-1. 테이블 삭제 (존재하면 삭제)
-- ************************************************************
BEGIN EXECUTE IMMEDIATE 'DROP TABLE TB_FLIGHT_PRICE_HISTORY CASCADE CONSTRAINTS'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP TABLE TB_WISHLIST CASCADE CONSTRAINTS'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP TABLE TB_FLIGHT CASCADE CONSTRAINTS'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP TABLE TB_SEARCH_LOG CASCADE CONSTRAINTS'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP TABLE TB_REVIEW CASCADE CONSTRAINTS'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP TABLE TB_SURVEY CASCADE CONSTRAINTS'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP TABLE TB_NOTICE_COMMENT CASCADE CONSTRAINTS'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP TABLE TB_NOTICE_ATTACHMENT CASCADE CONSTRAINTS'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP TABLE TB_NOTICE CASCADE CONSTRAINTS'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP TABLE TB_SOCIAL_ACCOUNT CASCADE CONSTRAINTS'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP TABLE TB_AUTH CASCADE CONSTRAINTS'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP TABLE TB_FLIGHT_OFFER CASCADE CONSTRAINTS'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP TABLE TB_MEMBER CASCADE CONSTRAINTS'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP TABLE TB_AIRPORT CASCADE CONSTRAINTS'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP TABLE TB_AIRLINE CASCADE CONSTRAINTS'; EXCEPTION WHEN OTHERS THEN NULL; END;
/

-- ************************************************************
-- 0-2. 시퀀스 삭제 (존재하면 삭제)
-- ************************************************************
BEGIN EXECUTE IMMEDIATE 'DROP SEQUENCE TB_SEARCH_LOG_SEQ'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP SEQUENCE TB_NOTICE_COMMENT_SEQ'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP SEQUENCE TB_AIRLINE_SEQ'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP SEQUENCE TB_MEMBER_SEQ'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP SEQUENCE TB_REVIEW_SEQ'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP SEQUENCE TB_NOTICE_ATTACHMENT_SEQ'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP SEQUENCE TB_FLIGHT_SEQ'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP SEQUENCE TB_NOTICE_SEQ'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP SEQUENCE TB_SOCIAL_ACCOUNT_SEQ'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP SEQUENCE TB_FLIGHT_OFFER_SEQ'; EXCEPTION WHEN OTHERS THEN NULL; END;
/
BEGIN EXECUTE IMMEDIATE 'DROP SEQUENCE TB_FLIGHT_PRICE_HISTORY_SEQ'; EXCEPTION WHEN OTHERS THEN NULL; END;
/

-- ************************************************************
-- 1. 시퀀스 생성
-- ************************************************************
CREATE SEQUENCE TB_SEARCH_LOG_SEQ START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE;
CREATE SEQUENCE TB_NOTICE_COMMENT_SEQ START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE;
CREATE SEQUENCE TB_AIRLINE_SEQ START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE;
CREATE SEQUENCE TB_MEMBER_SEQ START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE;
CREATE SEQUENCE TB_REVIEW_SEQ START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE;
CREATE SEQUENCE TB_NOTICE_ATTACHMENT_SEQ START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE;
CREATE SEQUENCE TB_FLIGHT_SEQ START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE;
CREATE SEQUENCE TB_NOTICE_SEQ START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE;
CREATE SEQUENCE TB_SOCIAL_ACCOUNT_SEQ START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE;
CREATE SEQUENCE TB_FLIGHT_OFFER_SEQ START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE;
CREATE SEQUENCE TB_FLIGHT_PRICE_HISTORY_SEQ START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE;

-- ************************************************************
-- 2. 테이블 생성 (PK/UK/FK 전부 여기서만)
-- ************************************************************

-- 1) MEMBER
CREATE TABLE TB_MEMBER (
  MEMBER_NO NUMBER NOT NULL,
  MEMBER_ID VARCHAR2(100) NOT NULL,
  MEMBER_PASSWORD VARCHAR2(255),
  MEMBER_NAME VARCHAR2(60) NOT NULL,
  MEMBER_BIRTH_DATE DATE NOT NULL,
  MEMBER_GENDER CHAR(1) NOT NULL,
  MEMBER_PHONE VARCHAR2(13),
  MEMBER_ROLE VARCHAR2(5) DEFAULT 'USER',
  MEMBER_CREATE_AT DATE DEFAULT SYSDATE NOT NULL,
  MEMBER_WITHDRAWN_AT DATE,
  MEMBER_LAST_LOGIN_AT DATE,
  MEMBER_IS_ACTIVE CHAR(1) DEFAULT 'Y' NOT NULL,
  MEMBER_LOGIN_FAIL_COUNT NUMBER DEFAULT 0 NOT NULL,
  MEMBER_IS_LOCKED CHAR(1) DEFAULT 'N' NOT NULL,
  MEMBER_UNLOCK_TIME DATE DEFAULT SYSDATE NOT NULL,

  CONSTRAINT PK_MEM PRIMARY KEY (MEMBER_NO),
  CONSTRAINT UK_MEM_ID UNIQUE (MEMBER_ID),
  CONSTRAINT CK_MEM_GDR CHECK (MEMBER_GENDER IN ('M', 'F'))
);

-- 2) AIRLINE
CREATE TABLE TB_AIRLINE (
  AIRLINE_ID NUMBER NOT NULL,
  AIRLINE_AIRLINE_NAME VARCHAR2(200) NOT NULL,
  AIRLINE_IATA_CODE VARCHAR2(3) NOT NULL,
  AIRLINE_COUNTRY VARCHAR2(100) NOT NULL,
  AIRLINE_URL VARCHAR2(200) NOT NULL,
  AIRPORT_TEAM VARCHAR2(255),

  CONSTRAINT PK_AIR PRIMARY KEY (AIRLINE_ID)
);

-- 3) AIRPORT
CREATE TABLE TB_AIRPORT (
  AIRPORT_IATA_CODE VARCHAR2(3) NOT NULL,
  AIRPORT_NAME VARCHAR2(200) NOT NULL,
  AIRPORT_CITY VARCHAR2(100) NOT NULL,
  AIRPORT_COUNTRY VARCHAR2(100) NOT NULL,
  AIRPORT_TIMEZONE VARCHAR2(50) NOT NULL,
  AIRPORT_LATITUDE NUMBER NOT NULL,
  AIRPORT_LONGITUDE NUMBER NOT NULL,
  AIRPORT_STATUS CHAR(1) DEFAULT 'N' NOT NULL,

  CONSTRAINT PK_APT PRIMARY KEY (AIRPORT_IATA_CODE)
);

-- 4) NOTICE
CREATE TABLE TB_NOTICE (
  NOTICE_ID NUMBER NOT NULL,
  NOTICE_TITLE VARCHAR2(150) NOT NULL,
  NOTICE_CONTENT VARCHAR2(500) NOT NULL,
  NOTICE_CREATED_AT DATE DEFAULT SYSDATE NOT NULL,
  NOTICE_UPDATED_AT DATE DEFAULT SYSDATE NOT NULL,
  NOTICE_VIEWS NUMBER NOT NULL,
  NOTICE_IS_IMPORTANT CHAR(1) DEFAULT 'N' NOT NULL,
  NOTICE_IS_DEL CHAR(1) DEFAULT 'N' NOT NULL,

  CONSTRAINT PK_NOT PRIMARY KEY (NOTICE_ID)
);

-- 5) FLIGHT_OFFER
CREATE TABLE TB_FLIGHT_OFFER (
  FLIGHT_OFFER_ID NUMBER NOT NULL,

  FLIGHT_OFFER_ONE_WAY CHAR(1) DEFAULT 'N' NOT NULL,
  FLIGHT_OFFER_DEPART_DATE DATE NOT NULL,
  FLIGHT_OFFER_RETURN_DATE DATE,

  FLIGHT_OFFER_DEP_DUR_TOTAL VARCHAR2(100) NOT NULL,
  FLIGHT_OFFER_RET_DUR_TOTAL VARCHAR2(100),

  FLIGHT_OFFER_EXTRA_SEAT NUMBER DEFAULT 0 NOT NULL,
  FLIGHT_OFFER_IS_DEL CHAR(1) DEFAULT 'N' NOT NULL,
  AIRLINE_ID NUMBER,

  CONSTRAINT PK_FOF PRIMARY KEY (FLIGHT_OFFER_ID),
  CONSTRAINT FK_FOF_AIR FOREIGN KEY (AIRLINE_ID) REFERENCES TB_AIRLINE (AIRLINE_ID)
);

-- 6) FLIGHT_PRICE_HISTORY
CREATE TABLE TB_FLIGHT_PRICE_HISTORY (
  FLIGHT_PRICE_HISTORY_NO NUMBER NOT NULL,
  FLIGHT_OFFER_ID NUMBER NOT NULL,

  FLIGHT_OFFER_PRICE_TOTAL NUMBER NOT NULL,
  FLIGHT_OFFER_CURRENCY VARCHAR2(10) DEFAULT 'KRW' NOT NULL,
  FLIGHT_OFFER_ONE_WAY CHAR(1) DEFAULT 'N' NOT NULL,

  FLIGHT_OFFER_DEPART_DATE DATE NOT NULL,
  FLIGHT_OFFER_RETURN_DATE DATE,

  FLIGHT_OFFER_API_QUERY_DATE DATE DEFAULT SYSDATE NOT NULL,

  DEPART_IATA_CODE VARCHAR2(3) NOT NULL,
  ARRIVE_IATA_CODE VARCHAR2(3) NOT NULL,
  AIRLINE_ID NUMBER,

  CONSTRAINT PK_PHI PRIMARY KEY (FLIGHT_PRICE_HISTORY_NO),
  CONSTRAINT FK_PHI_FOF FOREIGN KEY (FLIGHT_OFFER_ID) REFERENCES TB_FLIGHT_OFFER (FLIGHT_OFFER_ID),
  CONSTRAINT FK_PHI_DEP_APT FOREIGN KEY (DEPART_IATA_CODE) REFERENCES TB_AIRPORT (AIRPORT_IATA_CODE),
  CONSTRAINT FK_PHI_ARR_APT FOREIGN KEY (ARRIVE_IATA_CODE) REFERENCES TB_AIRPORT (AIRPORT_IATA_CODE),
  CONSTRAINT FK_PHI_AIR FOREIGN KEY (AIRLINE_ID) REFERENCES TB_AIRLINE (AIRLINE_ID)
);
CREATE INDEX IDX_PRICE_HISTORY_OFFER_DATE
ON TB_FLIGHT_PRICE_HISTORY (FLIGHT_OFFER_ID, FLIGHT_OFFER_API_QUERY_DATE);

-- 7) FLIGHT
CREATE TABLE TB_FLIGHT (
  FLIGHT_ID NUMBER NOT NULL,
  FLIGHT_SEGMENT_NO NUMBER NOT NULL,
  FLIGHT_NUMBER VARCHAR2(50) NOT NULL,
  FLIGHT_DEPART_DATE DATE DEFAULT SYSDATE NOT NULL,
  FLIGHT_ARRIVE_DATE DATE NOT NULL,
  FLIGHT_DURATION VARCHAR2(100) DEFAULT 'N' NOT NULL,
  FLIGHT_DIRECTION CHAR(1) NOT NULL,
  FLIGHT_IS_DEL CHAR(1) DEFAULT 'N' NOT NULL,
  DEPART_AIRPORT VARCHAR2(3) NOT NULL,
  DEST_AIRPORT VARCHAR2(3) NOT NULL,
  OPER_AIRLINE_ID NUMBER,
  SELLING_AIRLINE_ID NUMBER,
  FLIGHT_OFFER_ID NUMBER NOT NULL,

  CONSTRAINT PK_FLT PRIMARY KEY (FLIGHT_ID),
  CONSTRAINT FK_FLT_FOF FOREIGN KEY (FLIGHT_OFFER_ID) REFERENCES TB_FLIGHT_OFFER (FLIGHT_OFFER_ID),
  CONSTRAINT FK_FLT_DEP_APT FOREIGN KEY (DEPART_AIRPORT) REFERENCES TB_AIRPORT (AIRPORT_IATA_CODE),
  CONSTRAINT FK_FLT_DST_APT FOREIGN KEY (DEST_AIRPORT) REFERENCES TB_AIRPORT (AIRPORT_IATA_CODE),
  CONSTRAINT FK_FLT_OPR_AIR FOREIGN KEY (OPER_AIRLINE_ID) REFERENCES TB_AIRLINE (AIRLINE_ID),
  CONSTRAINT FK_FLT_SEL_AIR FOREIGN KEY (SELLING_AIRLINE_ID) REFERENCES TB_AIRLINE (AIRLINE_ID)
);

-- 8) WISHLIST
CREATE TABLE TB_WISHLIST (
  MEMBER_NO NUMBER NOT NULL,
  FLIGHT_OFFER_ID NUMBER NOT NULL,

  CONSTRAINT PK_WIS PRIMARY KEY (MEMBER_NO, FLIGHT_OFFER_ID),
  CONSTRAINT FK_WIS_MEM FOREIGN KEY (MEMBER_NO) REFERENCES TB_MEMBER (MEMBER_NO),
  CONSTRAINT FK_WIS_FOF FOREIGN KEY (FLIGHT_OFFER_ID) REFERENCES TB_FLIGHT_OFFER (FLIGHT_OFFER_ID)
);

-- 9) REVIEW
CREATE TABLE TB_REVIEW (
  REVIEW_NO NUMBER NOT NULL,
  REVIEW_CONTENT VARCHAR2(300) NOT NULL,
  REVIEW_RATING NUMBER DEFAULT 0,
  REVIEW_CREATE_DATE DATE DEFAULT SYSDATE NOT NULL,
  REVIEW_MODIFY_DATE DATE DEFAULT SYSDATE NOT NULL,
  REVIEW_STATUS CHAR(1) DEFAULT 'N' NOT NULL,
  MEMBER_NO NUMBER NOT NULL,
  AIRLINE_ID NUMBER NOT NULL,

  CONSTRAINT PK_REV PRIMARY KEY (REVIEW_NO),
  CONSTRAINT FK_REV_MEM FOREIGN KEY (MEMBER_NO) REFERENCES TB_MEMBER (MEMBER_NO),
  CONSTRAINT FK_REV_AIR FOREIGN KEY (AIRLINE_ID) REFERENCES TB_AIRLINE (AIRLINE_ID)
);

-- 10) SURVEY (회원당 1행)
CREATE TABLE TB_SURVEY (
  MEMBER_NO        NUMBER        NOT NULL,
  SURVEY_RESULT    VARCHAR2(255) NOT NULL,   -- 화면 표시용 라벨/문구
  SURVEY_TYPE      VARCHAR2(30)  NOT NULL,   -- 코드(RELAX/CITY/...)
  SURVEY_CREATED_AT DATE DEFAULT SYSDATE NOT NULL,
  SURVEY_UPDATED_AT DATE DEFAULT SYSDATE NOT NULL,

  CONSTRAINT PK_SUR PRIMARY KEY (MEMBER_NO),
  CONSTRAINT FK_SUR_MEM FOREIGN KEY (MEMBER_NO)
    REFERENCES TB_MEMBER (MEMBER_NO)
);


-- 11) SOCIAL_ACCOUNT
CREATE TABLE TB_SOCIAL_ACCOUNT (
  SOCIAL_ACCOUNT_NO NUMBER NOT NULL,
  MEMBER_NO NUMBER NOT NULL,
  SOCIAL_PROVIDER VARCHAR2(20) NOT NULL,
  SOCIAL_PROVIDER_UID VARCHAR2(100) NOT NULL,
  SOCIAL_EMAIL VARCHAR2(100),
  SOCIAL_CONNECTED_AT DATE DEFAULT SYSDATE NOT NULL,

  CONSTRAINT PK_SOC PRIMARY KEY (SOCIAL_ACCOUNT_NO),
  CONSTRAINT UK_SOC_PUID UNIQUE (SOCIAL_PROVIDER, SOCIAL_PROVIDER_UID),
  CONSTRAINT FK_SOC_MEM FOREIGN KEY (MEMBER_NO) REFERENCES TB_MEMBER (MEMBER_NO)
);

-- 12) NOTICE_ATTACHMENT
CREATE TABLE TB_NOTICE_ATTACHMENT (
  NOTICE_ATTACHMENT_ID NUMBER NOT NULL,
  NOTICE_ATTACHMENT_NAME VARCHAR2(255) NOT NULL,
  NOTICE_ATTACHMENT_UPDATE VARCHAR2(500) NOT NULL,
  NOTICE_ATTACHMENT_URL VARCHAR2(255) NOT NULL,
  NOTICE_ATTACHMENT_UPLOADED_AT DATE DEFAULT SYSDATE NOT NULL,
  NOTICE_ATTACHMENT_IS_DEL CHAR(1) DEFAULT 'N' NOT NULL,
  NOTICE_ID NUMBER,

  CONSTRAINT PK_NAT PRIMARY KEY (NOTICE_ATTACHMENT_ID),
  CONSTRAINT FK_NAT_NOT FOREIGN KEY (NOTICE_ID) REFERENCES TB_NOTICE (NOTICE_ID)
);

-- 13) NOTICE_COMMENT
CREATE TABLE TB_NOTICE_COMMENT (
  NOTICE_COMMENT_ID NUMBER NOT NULL,
  NOTICE_COMMENT_CONTENT VARCHAR2(300) NOT NULL,
  NOTICE_COMMENT_CREATED_AT DATE DEFAULT SYSDATE NOT NULL,
  NOTICE_COMMENT_UPDATED_AT DATE DEFAULT SYSDATE NOT NULL,
  NOTICE_COMMENT_IS_DEL CHAR(1) DEFAULT 'N' NOT NULL,
  NOTICE_ID NUMBER,
  MEMBER_NO NUMBER NOT NULL,

  CONSTRAINT PK_NCM PRIMARY KEY (NOTICE_COMMENT_ID),
  CONSTRAINT FK_NCM_NOT FOREIGN KEY (NOTICE_ID) REFERENCES TB_NOTICE (NOTICE_ID),
  CONSTRAINT FK_NCM_MEM FOREIGN KEY (MEMBER_NO) REFERENCES TB_MEMBER (MEMBER_NO)
);

-- 14) AUTH
CREATE TABLE TB_AUTH (
  AUTH_EMAIL VARCHAR2(100) NOT NULL,
  AUTH_CODE NUMBER NOT NULL,
  AUTH_DATE DATE DEFAULT SYSDATE NOT NULL,
  AUTH_VERIFIED CHAR(1) DEFAULT 'N' NOT NULL,

  CONSTRAINT PK_AUT PRIMARY KEY (AUTH_EMAIL)
);

-- 15) SEARCH_LOG
CREATE TABLE TB_SEARCH_LOG (
  SEARCH_LOG_NO NUMBER NOT NULL,
  SEARCH_LOG_ONE_WAY CHAR(1) DEFAULT 'N' NOT NULL,
  SEARCH_LOG_PASSENGER_COUNT NUMBER NOT NULL,
  SEARCH_LOG_DEPART_DATE DATE DEFAULT SYSDATE NOT NULL,
  SEARCH_LOG_RETURN_DATE DATE DEFAULT SYSDATE,
  SEARCH_LOG_DATE DATE DEFAULT SYSDATE,
  MEMBER_NO NUMBER,
  DEPART_IATA_CODE VARCHAR2(3) NOT NULL,
  ARRIVE_IATA_CODE VARCHAR2(3) NOT NULL,

  CONSTRAINT PK_LOG PRIMARY KEY (SEARCH_LOG_NO),
  CONSTRAINT FK_LOG_MEM FOREIGN KEY (MEMBER_NO) REFERENCES TB_MEMBER (MEMBER_NO),
  CONSTRAINT FK_LOG_DEP_APT FOREIGN KEY (DEPART_IATA_CODE) REFERENCES TB_AIRPORT (AIRPORT_IATA_CODE),
  CONSTRAINT FK_LOG_ARR_APT FOREIGN KEY (ARRIVE_IATA_CODE) REFERENCES TB_AIRPORT (AIRPORT_IATA_CODE)
);

-- ************************************************************
-- 3. 트리거 생성
-- ************************************************************
CREATE OR REPLACE TRIGGER TB_SEARCH_LOG_TRG
BEFORE INSERT ON TB_SEARCH_LOG
FOR EACH ROW
BEGIN
  IF :NEW.SEARCH_LOG_NO IS NULL THEN
    SELECT TB_SEARCH_LOG_SEQ.NEXTVAL INTO :NEW.SEARCH_LOG_NO FROM DUAL;
  END IF;
END;
/
CREATE OR REPLACE TRIGGER TB_NOTICE_COMMENT_TRG
BEFORE INSERT ON TB_NOTICE_COMMENT
FOR EACH ROW
BEGIN
  IF :NEW.NOTICE_COMMENT_ID IS NULL THEN
    SELECT TB_NOTICE_COMMENT_SEQ.NEXTVAL INTO :NEW.NOTICE_COMMENT_ID FROM DUAL;
  END IF;
END;
/
CREATE OR REPLACE TRIGGER TB_AIRLINE_TRG
BEFORE INSERT ON TB_AIRLINE
FOR EACH ROW
BEGIN
  IF :NEW.AIRLINE_ID IS NULL THEN
    SELECT TB_AIRLINE_SEQ.NEXTVAL INTO :NEW.AIRLINE_ID FROM DUAL;
  END IF;
END;
/
CREATE OR REPLACE TRIGGER TB_MEMBER_TRG
BEFORE INSERT ON TB_MEMBER
FOR EACH ROW
BEGIN
  IF :NEW.MEMBER_NO IS NULL THEN
    SELECT TB_MEMBER_SEQ.NEXTVAL INTO :NEW.MEMBER_NO FROM DUAL;
  END IF;
END;
/

CREATE OR REPLACE TRIGGER TB_REVIEW_TRG
BEFORE INSERT ON TB_REVIEW
FOR EACH ROW
BEGIN
  IF :NEW.REVIEW_NO IS NULL THEN
    SELECT TB_REVIEW_SEQ.NEXTVAL INTO :NEW.REVIEW_NO FROM DUAL;
  END IF;
END;
/
CREATE OR REPLACE TRIGGER TB_NOTICE_ATTACHMENT_TRG
BEFORE INSERT ON TB_NOTICE_ATTACHMENT
FOR EACH ROW
BEGIN
  IF :NEW.NOTICE_ATTACHMENT_ID IS NULL THEN
    SELECT TB_NOTICE_ATTACHMENT_SEQ.NEXTVAL INTO :NEW.NOTICE_ATTACHMENT_ID FROM DUAL;
  END IF;
END;
/
CREATE OR REPLACE TRIGGER TB_FLIGHT_TRG
BEFORE INSERT ON TB_FLIGHT
FOR EACH ROW
BEGIN
  IF :NEW.FLIGHT_ID IS NULL THEN
    SELECT TB_FLIGHT_SEQ.NEXTVAL INTO :NEW.FLIGHT_ID FROM DUAL;
  END IF;
END;
/
CREATE OR REPLACE TRIGGER TB_NOTICE_TRG
BEFORE INSERT ON TB_NOTICE
FOR EACH ROW
BEGIN
  IF :NEW.NOTICE_ID IS NULL THEN
    SELECT TB_NOTICE_SEQ.NEXTVAL INTO :NEW.NOTICE_ID FROM DUAL;
  END IF;
END;
/
CREATE OR REPLACE TRIGGER TB_SOCIAL_ACCOUNT_TRG
BEFORE INSERT ON TB_SOCIAL_ACCOUNT
FOR EACH ROW
BEGIN
  IF :NEW.SOCIAL_ACCOUNT_NO IS NULL THEN
    SELECT TB_SOCIAL_ACCOUNT_SEQ.NEXTVAL INTO :NEW.SOCIAL_ACCOUNT_NO FROM DUAL;
  END IF;
END;
/
CREATE OR REPLACE TRIGGER TB_FLIGHT_OFFER_TRG
BEFORE INSERT ON TB_FLIGHT_OFFER
FOR EACH ROW
BEGIN
  IF :NEW.FLIGHT_OFFER_ID IS NULL THEN
    SELECT TB_FLIGHT_OFFER_SEQ.NEXTVAL INTO :NEW.FLIGHT_OFFER_ID FROM DUAL;
  END IF;
END;
/
CREATE OR REPLACE TRIGGER TB_FLIGHT_PRICE_HISTORY_TRG
BEFORE INSERT ON TB_FLIGHT_PRICE_HISTORY
FOR EACH ROW
BEGIN
  IF :NEW.FLIGHT_PRICE_HISTORY_NO IS NULL THEN
    SELECT TB_FLIGHT_PRICE_HISTORY_SEQ.NEXTVAL INTO :NEW.FLIGHT_PRICE_HISTORY_NO FROM DUAL;
  END IF;
END;
/
-- ************************************************************
-- 4. COMMENT 추가 (누락 없이 전체 복구)
-- ************************************************************
COMMENT ON COLUMN TB_SEARCH_LOG.SEARCH_LOG_NO IS 'PK 저장을 위한 컬럼';
COMMENT ON COLUMN TB_SEARCH_LOG.DEPART_IATA_CODE IS '국제 3자리 공항 코드(ICN, GMP 등)';
COMMENT ON COLUMN TB_SEARCH_LOG.ARRIVE_IATA_CODE IS '국제 3자리 공항 코드(ICN, GMP 등)';

COMMENT ON COLUMN TB_AUTH.AUTH_EMAIL IS '회원의 아이디가 곧 이메일';
COMMENT ON COLUMN TB_AUTH.AUTH_CODE IS '인증번호';
COMMENT ON COLUMN TB_AUTH.AUTH_DATE IS '인증번호 발급 시각 (NOT NULL, SYSDATE)';

COMMENT ON COLUMN TB_NOTICE_COMMENT.MEMBER_NO IS '서비스 내 고유 번호 (PK, Sequence.NEXTVAL 사용)';

COMMENT ON COLUMN TB_WISHLIST.MEMBER_NO IS '서비스 내 고유 번호 (PK, Sequence.NEXTVAL 사용)';
COMMENT ON COLUMN TB_WISHLIST.FLIGHT_OFFER_ID IS '항공편 제안 ID (FK). 복합 PK 구성';

COMMENT ON COLUMN TB_AIRLINE.AIRLINE_ID IS '항공사 내부 식별자 (PK), 시퀀스';
COMMENT ON COLUMN TB_AIRLINE.AIRLINE_AIRLINE_NAME IS '대한항공, 아시아나 등';
COMMENT ON COLUMN TB_AIRLINE.AIRLINE_IATA_CODE IS '2자리 코드 (KE, OZ 등)';
COMMENT ON COLUMN TB_AIRLINE.AIRLINE_COUNTRY IS '국적 항공사 정보';
COMMENT ON COLUMN TB_AIRLINE.AIRLINE_URL IS '항공사 URL';

COMMENT ON COLUMN TB_MEMBER.MEMBER_NO IS '서비스 내 고유 번호 (PK, Sequence.NEXTVAL 사용)';
COMMENT ON COLUMN TB_MEMBER.MEMBER_ID IS 'Unique, Not Null 로그인 ID (이메일 형식)';
COMMENT ON COLUMN TB_MEMBER.MEMBER_PASSWORD IS '일반 로그인 비밀번호(해시 저장) 일반 회원의 경우 NOT NULL(유효성 검사로 해결해야함) 소셜 로그인의 경우 비밀번호를 따로 받아오지 않기 때문에 NULL을 허용';
COMMENT ON COLUMN TB_MEMBER.MEMBER_NAME IS 'NOT NULL 회원 이름(본명) 아이디 찾기 시 생년월일과 함께 필수로 사용됨.';
COMMENT ON COLUMN TB_MEMBER.MEMBER_BIRTH_DATE IS '생년월일. 아이디 찾기 시 회원 이름과 함께 필수로 사용됨.';
COMMENT ON COLUMN TB_MEMBER.MEMBER_GENDER IS '성별 (''M'', ''F''). 필수 입력 항목';
COMMENT ON COLUMN TB_MEMBER.MEMBER_PHONE IS '휴대폰 번호 (하이픈 제거된 숫자만) 하이폰은 프론트단에서 자동으로 입력받게 할거임 db에는 숫자만 저장';
COMMENT ON COLUMN TB_MEMBER.MEMBER_CREATE_AT IS '회원가입 시각';
COMMENT ON COLUMN TB_MEMBER.MEMBER_WITHDRAWN_AT IS '회원이 탈퇴한 시각 (IS_ACTIVE가 ''N''로 변경된 시각). 관리자 통계를 위해 기록.';
COMMENT ON COLUMN TB_MEMBER.MEMBER_LAST_LOGIN_AT IS 'LAST_LOGIN_AT이 NULL인 상태는 해당 회원의 최종 로그인 시각 정보가 없다(즉, 회원 가입 이후 로그인을 한적 이 없다.) 최종 로그인 시각은 장기 미로그인 시 계정 잠금 기능 때문에 필요한 것';
COMMENT ON COLUMN TB_MEMBER.MEMBER_IS_ACTIVE IS '계정의 최종 활성화 상태 (''Y'':활성, ''N'':비활성). 회원 탈퇴 또는 영구 정지 시 ''N''로 변경.';
COMMENT ON COLUMN TB_MEMBER.MEMBER_LOGIN_FAIL_COUNT IS '연속 로그인 실패 횟수 여러번 로그인 실패 시 계정 잠금하기 위해 만듦.';
COMMENT ON COLUMN TB_MEMBER.MEMBER_IS_LOCKED IS '로그인 실패 횟수 초과, 장기 미접속으로 인한 일시적인 보안 잠금 상태 (''Y'': 잠금, ''N'' : 정상)';

COMMENT ON COLUMN TB_FLIGHT_OFFER.FLIGHT_OFFER_ID IS '항공편 제안 ID (PK)';

COMMENT ON COLUMN TB_FLIGHT_OFFER.FLIGHT_OFFER_ONE_WAY IS '편도 여부 (Y/N)';
COMMENT ON COLUMN TB_FLIGHT_OFFER.FLIGHT_OFFER_IS_DEL IS '''Y''/''N''. 항공편 삭제/마감 여부 (DEL 롤백 반영)';
COMMENT ON COLUMN TB_FLIGHT_OFFER.AIRLINE_ID IS '내부 식별자 (PK)';


COMMENT ON COLUMN TB_SURVEY.MEMBER_NO IS '회원 PK(FK). 회원당 설문 결과 1행';
COMMENT ON COLUMN TB_SURVEY.SURVEY_TYPE IS '설문 결과 타입 코드(RELAX/CITY/...)';
COMMENT ON COLUMN TB_SURVEY.SURVEY_RESULT IS '표시용 결과 문구';
COMMENT ON COLUMN TB_SURVEY.SURVEY_UPDATED_AT IS '마지막 설문 완료/갱신 시각';


COMMENT ON COLUMN TB_REVIEW.REVIEW_NO IS 'SEQ 사용';
COMMENT ON COLUMN TB_REVIEW.REVIEW_RATING IS '별점';
COMMENT ON COLUMN TB_REVIEW.REVIEW_CREATE_DATE IS 'SYSDATE';
COMMENT ON COLUMN TB_REVIEW.REVIEW_MODIFY_DATE IS 'SYSDATE';
COMMENT ON COLUMN TB_REVIEW.REVIEW_STATUS IS '리뷰 상태 (Y/N)';
COMMENT ON COLUMN TB_REVIEW.MEMBER_NO IS '서비스 내 고유 번호 (PK, Sequence.NEXTVAL 사용)';
COMMENT ON COLUMN TB_REVIEW.AIRLINE_ID IS '내부 식별자 (PK)';

COMMENT ON COLUMN TB_AIRPORT.AIRPORT_IATA_CODE IS '국제 3자리 공항 코드(ICN, GMP 등) PK';
COMMENT ON COLUMN TB_AIRPORT.AIRPORT_NAME IS '인천국제공항 등 전체 공항명';
COMMENT ON COLUMN TB_AIRPORT.AIRPORT_CITY IS 'Seoul, Tokyo 등';
COMMENT ON COLUMN TB_AIRPORT.AIRPORT_COUNTRY IS 'Korea, Japan 등';
COMMENT ON COLUMN TB_AIRPORT.AIRPORT_TIMEZONE IS 'Asia/Seoul 등';
COMMENT ON COLUMN TB_AIRPORT.AIRPORT_LATITUDE IS '위도 몇?';
COMMENT ON COLUMN TB_AIRPORT.AIRPORT_LONGITUDE IS '경도 몇?';
COMMENT ON COLUMN TB_AIRPORT.AIRPORT_STATUS IS '공항 상태값 CHECK 제약조건 (Y/N)';

COMMENT ON COLUMN TB_FLIGHT.FLIGHT_ID IS 'PK';
COMMENT ON COLUMN TB_FLIGHT.FLIGHT_NUMBER IS '예:123';
COMMENT ON COLUMN TB_FLIGHT.FLIGHT_DURATION IS '예: PT2H35M';

COMMENT ON COLUMN TB_FLIGHT.FLIGHT_IS_DEL IS '항공편 마감 여부 (Y/N). DEL 롤백 반영.';
COMMENT ON COLUMN TB_FLIGHT.DEPART_AIRPORT IS '국제 3자리 공항 코드(ICN, GMP 등)';
COMMENT ON COLUMN TB_FLIGHT.DEST_AIRPORT IS '국제 3자리 공항 코드(ICN, GMP 등)';
COMMENT ON COLUMN TB_FLIGHT.OPER_AIRLINE_ID IS '내부 식별자 (PK)';
COMMENT ON COLUMN TB_FLIGHT.SELLING_AIRLINE_ID IS '내부 식별자 (PK)';
COMMENT ON COLUMN TB_FLIGHT.FLIGHT_OFFER_ID IS 'FK';

COMMENT ON COLUMN TB_NOTICE_ATTACHMENT.NOTICE_ATTACHMENT_ID IS '공지사항 첨부파일 PK';
COMMENT ON COLUMN TB_NOTICE.NOTICE_ID IS '공지사항 PK';

COMMENT ON COLUMN TB_SOCIAL_ACCOUNT.SOCIAL_ACCOUNT_NO IS '소셜 계정 식별용 PK (시퀀스 사용)';
COMMENT ON COLUMN TB_SOCIAL_ACCOUNT.MEMBER_NO IS '서비스 내 고유 번호 (PK, Sequence.NEXTVAL 사용)';
COMMENT ON COLUMN TB_SOCIAL_ACCOUNT.SOCIAL_PROVIDER IS '소셜 로그인 타입 구분을 위함';
COMMENT ON COLUMN TB_SOCIAL_ACCOUNT.SOCIAL_PROVIDER_UID IS '소셜 로그인에서 유저를 판별하는 유일한 기준';
COMMENT ON COLUMN TB_SOCIAL_ACCOUNT.SOCIAL_EMAIL IS '연동 provider의 email';
COMMENT ON COLUMN TB_SOCIAL_ACCOUNT.SOCIAL_CONNECTED_AT IS '소셜 회원가입 연동 시각';

COMMENT ON TABLE TB_FLIGHT_PRICE_HISTORY IS
'항공권 가격 변동 이력 테이블. 동일 항공편(FLIGHT_OFFER)에 대해 API 조회 시점별 가격을 누적 저장한다. 
목록 조회(최신 가격)와 가격 변동 차트(히스토리) 모두 이 테이블을 기준으로 처리한다.';

COMMENT ON COLUMN TB_FLIGHT_PRICE_HISTORY.FLIGHT_PRICE_HISTORY_NO IS
'가격 히스토리 PK (시퀀스 사용)';

COMMENT ON COLUMN TB_FLIGHT_PRICE_HISTORY.FLIGHT_OFFER_ID IS
'항공편 상품 구조 ID (TB_FLIGHT_OFFER FK)';

COMMENT ON COLUMN TB_FLIGHT_PRICE_HISTORY.FLIGHT_OFFER_PRICE_TOTAL IS
'API 조회 시점 기준 항공권 총 가격';

COMMENT ON COLUMN TB_FLIGHT_PRICE_HISTORY.FLIGHT_OFFER_API_QUERY_DATE IS
'가격 조회 기준 시각 (차트 X축)';


-- ************************************************************
-- 5. 데이터 수집용 더미데이터 추가 건드시면 안됩니다. 매일 api 호출할때 필요한 코드들입니다.
--    만약에 테이블을 수정하실때라면 주석처리하고 실행시켜주시고 만든 후에 다시 풀어주세여><
-- ************************************************************


-- 출발공항 고정 더미데이터
INSERT INTO TB_AIRPORT (
  AIRPORT_IATA_CODE,
  AIRPORT_NAME,
  AIRPORT_CITY,
  AIRPORT_COUNTRY,
  AIRPORT_TIMEZONE,
  AIRPORT_LATITUDE,
  AIRPORT_LONGITUDE,
  AIRPORT_STATUS
) VALUES (
  'ICN',
  '인천국제공항',
  'Seoul',
  'Korea',
  'Asia/Seoul',
  37.4602,
  126.4407,
  'Y'
);

-- 도착 공항 고정 더미데이터
INSERT INTO TB_AIRPORT (
  AIRPORT_IATA_CODE,
  AIRPORT_NAME,
  AIRPORT_CITY,
  AIRPORT_COUNTRY,
  AIRPORT_TIMEZONE,
  AIRPORT_LATITUDE,
  AIRPORT_LONGITUDE,
  AIRPORT_STATUS
) VALUES (
  'NRT',
  '나리타국제공항',
  'Tokyo',
  'Japan',
  'Asia/Tokyo',
  35.7767,
  140.3189,
  'Y'
);

-- TB_AIRPORT 더미데이터
INSERT ALL
    INTO TB_AIRPORT VALUES ('GMP','Gimpo International Airport','Seoul','Korea','Asia/Seoul',37.5583,126.7906,'Y')
    INTO TB_AIRPORT VALUES ('HND','Haneda Airport','Tokyo','Japan','Asia/Tokyo',35.5494,139.7798,'Y')
    INTO TB_AIRPORT VALUES ('DAD','Da Nang International Airport','Da Nang','Vietnam','Asia/Ho_Chi_Minh',16.0439,108.1994,'Y')
    INTO TB_AIRPORT VALUES ('HAN','Noi Bai International Airport','Hanoi','Vietnam','Asia/Ho_Chi_Minh',21.2187,105.8067,'Y')
    INTO TB_AIRPORT VALUES ('PVG','Shanghai Pudong International Airport','Shanghai','China','Asia/Shanghai',31.1443,121.8083,'Y')
SELECT 1 FROM DUAL;


-- 항공사 고정용 더미데이터
INSERT INTO TB_AIRLINE (
  AIRLINE_ID,
  AIRLINE_AIRLINE_NAME,
  AIRLINE_IATA_CODE,
  AIRLINE_COUNTRY,
  AIRLINE_URL,
  AIRPORT_TEAM
) VALUES (
  TB_AIRLINE_SEQ.NEXTVAL,
  '대한항공',
  'KE',
  'Korea',
  'https://www.koreanair.com',
  'KOREA'
);

INSERT INTO TB_AIRLINE VALUES (
  TB_AIRLINE_SEQ.NEXTVAL,
  '아시아나항공',
  'OZ',
  'Korea',
  'https://www.flyasiana.com',
  'KOREA'
);

INSERT INTO TB_AIRLINE VALUES (
  TB_AIRLINE_SEQ.NEXTVAL,
  '제주항공',
  '7C',
  'Korea',
  'https://www.jejuair.net',
  'KOREA'
);

INSERT INTO TB_AIRLINE VALUES (
  TB_AIRLINE_SEQ.NEXTVAL,
  '진에어',
  'LJ',
  'Korea',
  'https://www.jinair.com',
  'KOREA'
);

INSERT INTO TB_AIRLINE VALUES (
  TB_AIRLINE_SEQ.NEXTVAL,
  '티웨이항공',
  'TW',
  'Korea',
  'https://www.twayair.com',
  'KOREA'
);

INSERT INTO TB_AIRLINE VALUES (
  TB_AIRLINE_SEQ.NEXTVAL,
  '에어부산',
  'BX',
  'Korea',
  'https://www.airbusan.com',
  'KOREA'
);

INSERT INTO TB_AIRLINE VALUES (
  TB_AIRLINE_SEQ.NEXTVAL,
  '에어서울',
  'RS',
  'Korea',
  'https://www.flyairseoul.com',
  'KOREA'
);

-- =========================
-- 아시아 메이저
-- =========================

INSERT INTO TB_AIRLINE VALUES (
  TB_AIRLINE_SEQ.NEXTVAL,
  '전일본공수',
  'NH',
  'Japan',
  'https://www.ana.co.jp',
  'ASIA'
);

INSERT INTO TB_AIRLINE VALUES (
  TB_AIRLINE_SEQ.NEXTVAL,
  '일본항공',
  'JL',
  'Japan',
  'https://www.jal.co.jp',
  'ASIA'
);

INSERT INTO TB_AIRLINE VALUES (
  TB_AIRLINE_SEQ.NEXTVAL,
  '캐세이퍼시픽',
  'CX',
  'Hong Kong',
  'https://www.cathaypacific.com',
  'ASIA'
);

INSERT INTO TB_AIRLINE VALUES (
  TB_AIRLINE_SEQ.NEXTVAL,
  '싱가포르항공',
  'SQ',
  'Singapore',
  'https://www.singaporeair.com',
  'ASIA'
);

INSERT INTO TB_AIRLINE VALUES (
  TB_AIRLINE_SEQ.NEXTVAL,
  '타이항공',
  'TG',
  'Thailand',
  'https://www.thaiairways.com',
  'ASIA'
);

INSERT INTO TB_AIRLINE VALUES (
  TB_AIRLINE_SEQ.NEXTVAL,
  '베트남항공',
  'VN',
  'Vietnam',
  'https://www.vietnamairlines.com',
  'ASIA'
);

-- =========================
-- 글로벌 메이저
-- =========================

INSERT INTO TB_AIRLINE VALUES (
  TB_AIRLINE_SEQ.NEXTVAL,
  '유나이티드항공',
  'UA',
  'USA',
  'https://www.united.com',
  'GLOBAL'
);

INSERT INTO TB_AIRLINE VALUES (
  TB_AIRLINE_SEQ.NEXTVAL,
  '델타항공',
  'DL',
  'USA',
  'https://www.delta.com',
  'GLOBAL'
);

INSERT INTO TB_AIRLINE VALUES (
  TB_AIRLINE_SEQ.NEXTVAL,
  '아메리칸항공',
  'AA',
  'USA',
  'https://www.aa.com',
  'GLOBAL'
);

INSERT INTO TB_AIRLINE VALUES (
  TB_AIRLINE_SEQ.NEXTVAL,
  '루프트한자',
  'LH',
  'Germany',
  'https://www.lufthansa.com',
  'GLOBAL'
);

INSERT INTO TB_AIRLINE VALUES (
  TB_AIRLINE_SEQ.NEXTVAL,
  '에어프랑스',
  'AF',
  'France',
  'https://www.airfrance.com',
  'GLOBAL'
);

INSERT INTO TB_AIRLINE VALUES (
  TB_AIRLINE_SEQ.NEXTVAL,
  'KLM 네덜란드항공',
  'KL',
  'Netherlands',
  'https://www.klm.com',
  'GLOBAL'
);

INSERT INTO TB_AIRLINE VALUES (
  TB_AIRLINE_SEQ.NEXTVAL,
  '에미레이트항공',
  'EK',
  'UAE',
  'https://www.emirates.com',
  'GLOBAL'
);

-- 검색기록 고정 더미데이터
INSERT INTO TB_SEARCH_LOG (
  SEARCH_LOG_NO,
  SEARCH_LOG_ONE_WAY,
  SEARCH_LOG_PASSENGER_COUNT,
  SEARCH_LOG_DEPART_DATE,
  SEARCH_LOG_RETURN_DATE,
  SEARCH_LOG_DATE,
  MEMBER_NO,
  DEPART_IATA_CODE,
  ARRIVE_IATA_CODE
) VALUES (
  TB_SEARCH_LOG_SEQ.NEXTVAL,   -- PK
  'Y',                         -- 편도
  1,                           -- 승객 1명
  TRUNC(SYSDATE) + 30,         -- 출발일 (D+30)
  NULL,                        -- 편도라서 귀국일 없음
  SYSDATE,                     -- 검색 기록 생성일
  NULL,                        -- 비회원/시스템 수집
  'ICN',                       -- 출발 공항
  'NRT'                        -- 도착 공항
);

INSERT INTO TB_MEMBER (
    MEMBER_NO,
    MEMBER_ID,
    MEMBER_PASSWORD,
    MEMBER_NAME,
    MEMBER_BIRTH_DATE,
    MEMBER_GENDER,
    MEMBER_PHONE,
    MEMBER_ROLE,
    MEMBER_CREATE_AT,
    MEMBER_WITHDRAWN_AT,
    MEMBER_LAST_LOGIN_AT,
    MEMBER_IS_ACTIVE,
    MEMBER_LOGIN_FAIL_COUNT,
    MEMBER_IS_LOCKED,
    MEMBER_UNLOCK_TIME
) VALUES (
    1,
    'test@triptype.com',
    'dummy_password_hash',
    '테스트회원',
    DATE '1999-01-01',
    'M',
    '01012345678',
    'USER',
    SYSDATE,
    NULL,
    NULL,
    'Y',
    0,
    'N',
    SYSDATE
);


-- 통계 더미 데이터
INSERT INTO TB_MEMBER (
    MEMBER_NO,
    MEMBER_ID,
    MEMBER_PASSWORD,
    MEMBER_NAME,
    MEMBER_BIRTH_DATE,
    MEMBER_GENDER,
    MEMBER_PHONE,
    MEMBER_ROLE,
    MEMBER_CREATE_AT,
    MEMBER_IS_ACTIVE
)
SELECT
    TB_MEMBER_SEQ.NEXTVAL,
    'active_' || LEVEL || '@test.com',
    'pass1234',
    '활성회원' || LEVEL,
    DATE '1995-01-01',
    'M',
    '010-1111-2222',
    'USER',
    ADD_MONTHS(TRUNC(SYSDATE, 'MM'), -MOD(LEVEL, 12)),
    'Y'
FROM DUAL
CONNECT BY LEVEL <= 60;


INSERT INTO TB_MEMBER (
    MEMBER_NO,
    MEMBER_ID,
    MEMBER_PASSWORD,
    MEMBER_NAME,
    MEMBER_BIRTH_DATE,
    MEMBER_GENDER,
    MEMBER_PHONE,
    MEMBER_ROLE,
    MEMBER_CREATE_AT,
    MEMBER_WITHDRAWN_AT,
    MEMBER_IS_ACTIVE
)
SELECT
    TB_MEMBER_SEQ.NEXTVAL,
    'withdraw_' || LEVEL || '_' || TO_CHAR(SYSDATE, 'HH24MISS') || '@test.com',
    'pass1234',
    '탈퇴회원' || LEVEL,
    DATE '1990-01-01',
    'F',
    '010-3333-4444',
    'USER',
    ADD_MONTHS(TRUNC(SYSDATE, 'MM'), -MOD(LEVEL, 12)),
    ADD_MONTHS(TRUNC(SYSDATE, 'MM'), -MOD(LEVEL, 12) + MOD(LEVEL, 3) + 1),
    'N'
FROM DUAL
CONNECT BY LEVEL <= 36;

-- 항공사 리뷰 더미 데이터
-- 대한항공 (1)
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '서비스가 전반적으로 만족스러웠습니다.', 5, SYSDATE-10, SYSDATE-10, 'Y', 1, 1);
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '좌석이 편안하고 승무원이 친절했어요.', 4, SYSDATE-9,  SYSDATE-9,  'Y', 2, 1);
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '기내식이 조금 아쉬웠습니다.',        3, SYSDATE-8,  SYSDATE-8,  'Y', 3, 1);

-- 아시아나항공 (2)
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '전반적으로 무난한 항공사입니다.',    4, SYSDATE-7,  SYSDATE-7,  'Y', 4, 2);
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '승무원 응대가 좋았습니다.',          5, SYSDATE-6,  SYSDATE-6,  'Y', 5, 2);
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '지연이 조금 있었습니다.',           3, SYSDATE-5,  SYSDATE-5,  'Y', 6, 2);

-- 제주항공 (3)
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '가격 대비 만족합니다.',              4, SYSDATE-6,  SYSDATE-6,  'Y', 7, 3);
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '좌석 간격이 좁아요.',                3, SYSDATE-5,  SYSDATE-5,  'Y', 8, 3);
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '가성비 항공사로 괜찮아요.',          4, SYSDATE-4,  SYSDATE-4,  'Y', 9, 3);

-- 진에어 (4)
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '가격이 합리적입니다.',               4, SYSDATE-6,  SYSDATE-6,  'Y', 10, 4);
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '기내 서비스는 평범합니다.',         3, SYSDATE-5,  SYSDATE-5,  'Y', 11, 4);

-- 티웨이항공 (5)
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '저가항공 치고 괜찮아요.',             4, SYSDATE-4,  SYSDATE-4,  'Y', 12, 5);
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '좌석이 다소 불편했습니다.',         2, SYSDATE-3,  SYSDATE-3,  'Y', 13, 5);

-- 에어부산 (6)
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '부산 출발 노선이 편리해요.',         5, SYSDATE-4,  SYSDATE-4,  'Y', 14, 6);
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '승무원이 친절했습니다.',             4, SYSDATE-3,  SYSDATE-3,  'Y', 15, 6);

-- ANA (8)
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '일본 항공사답게 서비스가 깔끔합니다.', 5, SYSDATE-6,  SYSDATE-6,  'Y', 16, 8);
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '시간 정확도가 높아요.',              5, SYSDATE-5,  SYSDATE-5,  'Y', 17, 8);

-- JAL (9)
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '기내 서비스가 매우 좋았습니다.',     5, SYSDATE-6,  SYSDATE-6,  'Y', 18, 9);
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '가격이 조금 비싸요.',               4, SYSDATE-5,  SYSDATE-5,  'Y', 19, 9);

-- 싱가포르항공 (11)
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '세계 최고 수준의 서비스입니다.',     5, SYSDATE-6,  SYSDATE-6,  'Y', 14, 11);
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '기내식이 훌륭했어요.',               5, SYSDATE-5,  SYSDATE-5,  'Y', 12, 11);

-- 에미레이트항공 (20)
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '좌석과 기내 시설이 최고입니다.',     5, SYSDATE-6,  SYSDATE-6,  'Y', 25, 20);
INSERT INTO TB_REVIEW VALUES (TB_REVIEW_SEQ.NEXTVAL, '장거리 비행에도 편안했어요.',       5, SYSDATE-5,  SYSDATE-5,  'Y', 1, 20);

COMMIT;

